# vim编辑器

- 文本编辑器：编辑纯 ASCII 的文档，没有多余的修饰符
- 字处理器：除了基本的文字之外还保存其他附加信息
- vim是一种全屏编辑器，模式化编辑器

### vim模式：

1. 编辑模式（命令模式）—执行命令

   在该模式中，可以输入命令来执行许多种功能。控制屏幕光标的移动，字符、字或行的删除，移动复制某区段及进入Insert mode下，或者到 last line mode。

2. 输入模式—输入文本

   vi被运行时，通常处在命令模式下，键入以下命令 可以使vi退出命令模式，进入输入模式：I（i）、A（a）、O（o）。

3. 末行模式—执行待定命令

   将文件保存或退出vi，也可以设置编辑环境，如寻找字符串、列出行号……等。

模式转换：

```mermaid
graph LR;
　　输入模式-->编辑模式;  
　　编辑模式-->末行模式;
　　编辑模式-->输入模式;
　　末行模式-->编辑模式;
```

- 编辑模式-->输入模式：

  ```
  i：在当前光标所在字符的前面，转为输入模式；
  a：在当前光标所在字符的后面，转为输入模式；
  o：在当前光标所在行的下方，新建一行，并转为输入模式；

  I：在当前光标所在行的行首，转换为输入模式
  A：在当前光标所在行的行尾，转换为输入模式
  O：在当前光标所在行的上方，新建一行，并转为输入模式；
  ```


- 输入模式-->编辑模式：

  ```
  ESC
  ```


- 编辑模式-->末行模式：

  ```
  :
  ```

- 末行-->编辑：

  ```
  ESC, ESC
  ```


### 一、打开文件

```shell
# vim /path/to/somefile
vim +# :打开文件，并定位于第#行 
vim +：打开文件，定位至最后一行
vim +/PATTERN ：打开文件，定位至第一次被PATTERN匹配到的行的行首
默认处于编辑模式
```

### 二、关闭文件

```shell
# 1、末行模式关闭文件
:q  退出
:wq 保存并退出
:q! 不保存并退出
:w 保存
:w! 强行保存  # 只读文件，对于管理员可以强行保存
:wq --> :x
# 2、编辑模式下退出
ZZ：保存并退出
```

### 三、移动光标(编辑模式)

1. 逐字符移动：

  ```
  h：左
  l：右
  j：下
  k：上
  <数字>h：移动n个字符
  ```

2. 以单词为单位移动

  ```
  w：移至下一个单词的词首
  e：跳至当前或下一个单词的词尾
  b：跳至当前或前一个单词的词首
  <数字>w：跳n个单词
  ```

3. 行内跳转：

  ```
  0：跳至绝对行首
  ^：跳至行首的第一个非空白字符
  $：跳至绝对行尾
  ```

4. 行间跳转

  ```
  <数字>G：跳转至第n行；
  G：跳至最后一行
  末行模式下，直接给出行号，回车即可
  ```

### 四、翻屏(编辑模式)

```
Ctrl+f：向下翻一屏
Ctrl+b：向上翻一屏
Ctrl+d：向下翻半屏
Ctrl+u：向上翻半屏
```

### 五、删除单个字符

```
x：删除光标所在处的单个字符
<数字>x：删除光标所在处及向后的共n个字符
```

### 六、删除命令：d

```
d命令可以跟跳转命令组合使用；
如：dw, de, db, d$
dd：删除当前光标所在行
<数字>dd：删除包括当前光标所在行在内的n行；

末行模式下：
StartADD,EndADDd
.：表示当前行
$：最后一行
$-1：倒数第二行，等等...
+<数字>：向下的n行

删除的内容可以撤销，最后一次删除的内容可以粘贴
```

### 七、粘贴命令：p

```
p:如果删除或复制为整行内容，则粘贴至光标所在行的下方，如果复制或删除的内容为非整行，则粘贴至光标所在字符的后面；
P:如果删除或复制为整行内容，则粘贴至光标所在行的上方，如果复制或删除的内容为非整行，则粘贴至光标所在字符的前面；
```

### 八、复制命令：y

	用法同d命令
### 九、修改命令：先删除内容，再转换为输入模式

	c：用法同d命令
### 十、替换命令：

```
r：替换单个字符
R：替换模式，替换多个字符，ESC退出
```

### 十一、撤消编辑操作：u（undo）

	u：撤消前一次的编辑操作
	连续u命令可撤消此前的n次编辑操作
	<数字>u：直接撤消最近n次编辑操作
	撤消最近一次撤消操作：Ctrl+r
### 十二、重复前一次编辑操作

```
.
```

### 十三、可视化模式

```
v：按字符选取，并在输入相应命令后执行编辑操作
V：按矩形选取
```

### 十四、查找

```
/PATTERN：从当前往后找
?PATTERN：从当前往前找
n：往后跳转
N：往前跳转
```

### 十五、查找并替换

```
在末行模式下使用s命令（和 sed 一样）
起始地址,结束地址s@PATTERN@string@gi
1,$：表示全文
%：表示全文
```

练习：

将/etc/yum.repos.d/server.repo文件中的ftp://instructor.example.com/pub替换为http://172.16.0.1/yum

```shell
%s/ftp:\/\/instructor\.example\.com\/pub/http:\/\/172.16.0.1\/yum/g
%s@ftp://instructor\.example\.com/pub@http://172.16.0.1/yum@g
```

### 十六、使用vim编辑多个文件

```
vim FILE1 FILE2 FILE3
:next 切换至下一个文件
:prev 切换至前一个文件
:last 切换至最后一个文件
:first 切换至第一个文件
退出
:qa 全部退出
```

### 十七、分屏显示一个文件

```
Ctrl+w，松开后按， s：水平拆分窗口
Ctrl+w，松开后按， v：垂直拆分窗口

在窗口间切换光标：
Ctrl+w，松开后按，ARROW(上下左右键)

:qa 关闭所有窗口
```

### 十八、分窗口编辑多个文件

```
vim -o ：水平分割显示
vim -O ：垂直分割显示
```

### 十九、将当前文件中部分内容另存为另外一个文件

```
末行模式下使用w命令
:w
:ADDR1,ADDR2w /path/to/somewhere
```

### 二十、将另外一个文件的内容填充在当前文件中

```
:r /path/to/somefile
```

### 二十一、跟shell交互

```
:! COMMAND
```

### 二十二、高级话题

1. 显示或取消显示行号(仅对当前vim进程有效)

   ```
   :set number
   :set nu
   :set nonu
   ```


2. 显示忽略或区分字符大小写

   ```
   :set ignorecase
   :set ic
   :set noic
   ```


3. 设定自动缩进

   ```
   :set autoindent
   :set ai
   :set noai
   ```


4. 查找到的文本高亮显示或取消

   ```
   :set hlsearch
   :set nohlsearch
   ```


5. 语法高亮

   ```
   :syntax on
   :syntax off
   ```

### 二十三、配置文件

```shell
/etc/vimrc：对所有用户都生效
~/.vimrc：该用户家目录下隐藏文件
```



###  vimtutor命令：教你学习vim

