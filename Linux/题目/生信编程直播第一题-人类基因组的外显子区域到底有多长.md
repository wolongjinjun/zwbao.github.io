# 生信编程直播(第一题)-人类基因组的外显子区域到底有多长

## 题目
- 基础知识
    - 外显子的侧翼长度：在每个断裂基因的两侧都有一段在转录调控中起重要作用的非编码序列，称为侧翼序列。侧翼基因：在第一个和最后一个外显子的外侧，都有一段不被转录的非编码区。称为侧翼序列，包括启动子(promoter)，增强子(enhancer)，终止子(terminator)等。侧翼序列调节基因表达。侧翼序列就是侧翼基因。侧翼区特异性可以作为基因探针，侧翼基因在第一个和最后一个外显子的外侧，都有一段不被转录的非编码区·称为侧翼序列。相当于有一个参照。
    - 外显子就是RNA剪接后留下的部分，所以，你会发现外显子的长度要大于 CDS，因为CDS是编码一段蛋白产物的序列，而外显子包括AUG以前的mRNA编码前导序列。cds区一定属于外显子，但是外显子不一定是CDS区，也就是说外显子不一定都能翻译成蛋白。

![mark](http://oo3g995ih.bkt.clouddn.com/blog/180125/2fk2cliL5h.png?imageslim)

首先，我们要知道外显子的坐标文件，参考：http://www.bio-info-trainee.com/1101.html
可以看到根据NCBI的CCDS参考，统计到的外显子全才是34729283bp，也就是约35M，根很多文献里面说的都一样！统计一下外显子的侧翼长度：

- 54692160 外显子加上前后50bp
- 73066288  外显子加上前后100bp
- 90362533  外显子加上前后150bp

而hg19版本基因组里面有着entrez gene ID号的基因是23056个基因，所以我接下来探究一下这些基因的信息！

我们首先看看基因与基因之间的交叉情况：其中有12454266bp的位点，是多个外显子共有的，可能是一个基因的多个外显子，或者是不同基因的外显子

我们主要看看不同基因的交叉情况：不同基因交叉情况共516种，共涉及498种基因！

## 我的答案
1. 首先[下载consensus coding sequence (CCDS)记录](ftp://ftp.ncbi.nlm.nih.gov/pub/CCDS/current_human/CCDS.20160908.txt)得到CCDS.20160908.txt
2. `head` 一下看看，可见在括号里的就是坐标了

```
#chromosome	nc_accession	gene	gene_id	ccds_id	ccds_status	cds_strand	cds_from	cds_to	cds_locations	match_type
1	NC_000001.8	LINC00115	79854	CCDS1.1	Withdrawn	-	-	-	-	None
1	NC_000001.11	SAMD11	148398	CCDS2.2	Public	+	925941	944152	[925941-926012, 930154-930335, 931038-931088, 935771-935895, 939039-939128, 939274-939459, 941143-941305, 942135-942250, 942409-942487, 942558-943057, 943252-943376, 943697-943807, 943907-944152]	Identical
1	NC_000001.11	NOC2L	26155	CCDS3.1	Public	-	944693	959239	[944693-944799, 945056-945145, 945517-945652, 946172-946285, 946401-946544, 948130-948231, 948489-948602, 951126-951237, 951999-952138, 952411-952599, 953174-953287, 953781-953891, 954003-954081, 955922-956012, 956094-956214, 956893-957024, 957098-957272, 958928-959080, 959214-959239]	Identical
1	NC_000001.11	PLEKHN1	84069	CCDS4.1	Public	+	966531	974574	[966531-966613, 966703-966802, 970276-970422, 970520-970600, 970685-970757, 970878-971005, 971112-971207, 971323-971403, 972074-972149, 972287-972423, 972860-973009, 973185-973325, 973499-973639, 973832-974050, 974315-974363, 974441-974574]	Identical
1	NC_000001.11	HES4	57801	CCDS5.1	Public	-	999058	999972	[999058-999431, 999525-999612, 999691-999786, 999865-999972]	Identical
1	NC_000001.11	ISG15	9636	CCDS6.1	Public	+	1013573	1014477	[1013573-1013575, 1013983-1014477]	Identical
1	NC_000001.11	C1orf159	54991	CCDS7.2	Public	-	1082892	1091542	[1082892-1082986, 1084352-1084382, 1084480-1084505, 1085877-1086011, 1087138-1087203, 1087501-1087596, 1090352-1090427, 1091471-1091542]	Identical
1	NC_000001.11	TTLL10	254173	CCDS8.1	Public	+	1180053	1185141	[1180053-1180339, 1180482-1180600, 1180730-1180859, 1181740-1181814, 1182360-1182445, 1182875-1183046, 1183919-1184090, 1184968-1185141]	Identical
1	NC_000001.11	TNFRSF18	8784	CCDS9.1	Public	-	1203590	1206570	[1203590-1203959, 1204398-1204485, 1205369-1205491, 1206384-1206570]	Identical
```

3. 我的思路是，用`grep`取出坐标，再用`sort -u`去重，最后用`awk`算出长度，故代码如下：

```bash
grep -o "[0-9]\{1,\}-[0-9]\{1,\}" CCDS.20160908.txt | sort -u | awk 'BEGIN{FS ="-"}{cds=$2-$1+1;sum+=cds}END{print sum}'
```

4. 做题的过程中，我发现，原来`uniq`和`sort -u`这两个命令是不同的。`uniq`所谓的重复是连续出现的相同记录。而`sort -u`是全局的。

```shell
[root@VM_180_248_centos test]# grep -o "[0-9]\{1,\}-[0-9]\{1,\}" CCDS.20160908.txt | sort -u | awk 'BEGIN{FS ="-"}{cds=$2-$1+1;sum+=cds}END{print sum}'
36237103
[root@VM_180_248_centos test]# grep -o "[0-9]\{1,\}-[0-9]\{1,\}" CCDS.20160908.txt | uniq | awk 'BEGIN{FS ="-"}{cds=$2-$1+1;sum+=cds}END{print sum}'
57656084
```

5. 【18.1.31更新】发现之前的答案写错了，看一下上次`grep`出来的东西，前面27行是完全不相干的东西：

```shell
grep -o "[0-9]\{1,\}-[0-9]\{1,\}" CCDS.20160908.txt | sort -nu | head -n30
```

```
1-1
2-5
3-2
4-4
5-1
6-1
7-3
8-1
9-3
10-8
11-1
12-4
13-2
15-1
16-1
17-1
19-1
20-1
21-2
22-1
23-1
24-1
25-1
26-1
27-1
29-1
61-1
14806-14939
15080-15148
15908-16060
```

问题出在：

用`grep`匹配外显子的时候需要在两边加上`\b`进行位置锚定，否则会匹配到其他东西 。

所以改正过的代码为：

```shell
grep -o "\b[0-9]\{1,\}-[0-9]\{1,\}\b" CCDS.20160908.txt | sort -nu | awk 'BEGIN{FS ="-"}{cds=$2-$1+1;sum+=cds}END{print sum}'
```

改过的答案是：

```
35446705
```

---
:yum: 我还是一个小小白，平时的笔记一定有不少疏漏之处，恳请各位大佬批评指正！